##### My Cheat Sheets #####

##### Converting Rails MRI project to JRuby
In .ruby-version:
  jruby-1.7.4
In Gemfile:
  # gem "therubyracer"
  gem "therubyrhino"
  gem "activerecord-jdbcmysql-adapter"
  # gem "activerecord-mysql-adapter"
  # gem "mysql2"
  # gem "sqlite3"
In config/database.yml: (all environments)
  adapter: mysql
Yieldmanager gem must be at least 0.9.6
bundle
NOTE: won't run under POW!? (tries to run as 1.9.3)

##### Pry
binding.pry # add to source code or test: pry pauses here
help # show pry help
cd Class # make that class local: cd by itself jumps out
ls <something> # show vars, methods
? <something> # show ri docs
$ <something> # show source

##### irb-config for running tests with vim/tmux
,c # open dedicated tmux pane running rails console
,C # close dedicated tmux pane
,q # quiet activerecord logging
,t # run the current test
,T # run all the tests
,W # write/reload the current file in the console

##### TMUX
# ~/.tmux.conf
# prefix: ctrl-a (capslock is remapped to ctrl)
SESSIONS
  tls # from command-line to see a list of sessions
  ta <session name> # from command-line to re-attach to a live session
  tmux new -s <session name>
  prefix d to detach and leave session running
  tmux kill-session -t <session name>
  prefix s # list all (or switch) sessions
  prefix : new -s <session name> # create new session from within tmux session
WINDOWS
  prefix c # create window
  prefix , # rename current window
  prefix n,p # next/previous window
  prefix <num> # jump to that window
  prefix f # find window in this session
  prefix w # display all windows in this session
  prefix & # close current window
PANES
  prefix |,- # vertical/horizontal split
  prefix x # close pane: exiting shell also works
  prefix h,j,k,l # move to pane in that direction
  prefix H,J,K,L # resize pane by moving panel border that direction
  prefix x # close current pane

##### Gist.vim (https://github.com/vim-scripts/Gist.vim)
:Gist # Send entire file to gist. Run with area selected to send part of file
:Gist -s "some description" # create gist with description
:Gist -e -s "new description" # push edits and update description
:Gist -l # Show all my public gists
:Gist -l <user> # Show all user's public gists
:Gist -f # fork opened gist
:Gist 99999 # Get gist #99999

##### Capybara (https://github.com/jnicklas/capybara)
# require 'capybara/rspec' # in spec_helper
# for rails, put capybara specs in spec/features
# outside rails, tag all groups with :type => :feature
# outside rails, add to spec_helper: Capybara.app = MyRackApp
# for js specs, tag with :js => true
NAVIGATION
  visit "/blog"
  visit blogs_path
  click_link "Sign in"
PAGE INTERACTION AND SCOPING
  within("footer") { expect(page).to have_content("Copyright") }
  page.has_content?("Sign in")
  wait_until { page.has_content?("Data loaded!") }
PAGE MATCHERS
  expect(page).to have_content("What are you looking for?")
  expect(page).to have_css("header")
  expect(page).to have_css("table#records + .pagination a[rel='next']")
NODE INTERACTIONS
  find("article a.title").click
  find("input[name='post[title]']").trigger("focus")
  wait_until { find(".navigation").visible? } # useful for JavaScript-created elements
FORM INTERACTIONS
  fill_in "Title", :with => "I love RSpec!" # text/textareas
  fill_in "post[title]", :with => "I love RSpec!" # text/textareas
  check "I accept the terms of the site" # check boxes
  uncheck "Please spam me" # check boxes
  select "Moderate", :from => "Political Party" # select boxes
  select "MI", :from => "State" # select boxes
  choose "Very Interested" # radio buttons
  click_on "Create my account" # works with buttons or links
DEBUGGING
  save_and_open_page

##### Zencoding (aka Emmet.vim)
Everything fired with ctrl+y ,
html:5 # generate standard html file
div#foo.bar # <div id='foo' class='bar'></div>
ol>li#foo$*2 # <ol><li id='foo1'></li><li id='foo2'></li></ol>

##### Minitest (http://www.confreaks.com/videos/2713-arrrrcamp2013-a-big-look-at-minitest)
# Recommended:
# gem install cheat; cheat minitest
#
require 'minitest/autorun'

# to use context instead of nested describes: optional
class Minitest::Spec
  class << self
    alias :context, :describe
  end
end

class Foo
  def add(x, y)
    x + y
  end
end

describe Foo do

  let(:something) { [ 1, 2, 3 ] }

  before do # before each test
    @foo = 1
  end

  after do # after each test
    @foo = nil
  end

  context '#add' do
    it 'adds two numbers' do
      Foo.new.add(1,2).must_equal 3
    end
  end

  context 'skips' do
    it 'this because no block'

    it 'this explicitly' do
      skip
    end

    it 'this explicitly' do
      skip 'and outputs a reason'
    end
  end

  context 'expectations' do
    it 'goes both ways' do
      true.must_be true
      true.wont_be false
    end
  end
end
